{"version":3,"sources":["../src/deflate.js"],"names":["deflate","node","index","path","id","__typename","route","join","fieldNames","Object","keys","result","fieldName","value","Array","isArray","map","childNode","concat","response"],"mappings":";;;;;;;AAEA;AACA,MAAMA,UAAU,CAACC,IAAD,EAAeC,KAAf,EAA8BC,IAA9B,KAA+D;AAC7E,MAAIF,QAAQA,KAAKG,EAAb,IAAmBH,KAAKI,UAA5B,EAAwC;AACtC,UAAMC,QAAQH,KAAKI,IAAL,CAAU,GAAV,CAAd;;AAEA,QAAIL,MAAMI,KAAN,KAAgBJ,MAAMI,KAAN,EAAaL,KAAKI,UAAlB,CAAhB,IAAiDH,MAAMI,KAAN,EAAaL,KAAKI,UAAlB,EAA8BJ,KAAKG,EAAnC,CAArD,EAA6F;AAC3F,aAAO;AACL;AACAC,oBAAYJ,KAAKI,UAFZ;AAGLD,YAAIH,KAAKG;AAHJ,OAAP;AAKD,KAND,MAMO;AACL,UAAI,CAACF,MAAMI,KAAN,CAAL,EAAmB;AACjBJ,cAAMI,KAAN,IAAe,EAAf;AACD;;AAED,UAAI,CAACJ,MAAMI,KAAN,EAAaL,KAAKI,UAAlB,CAAL,EAAoC;AAClCH,cAAMI,KAAN,EAAaL,KAAKI,UAAlB,IAAgC,EAAhC;AACD;;AAEDH,YAAMI,KAAN,EAAaL,KAAKI,UAAlB,EAA8BJ,KAAKG,EAAnC,IAAyC,IAAzC;AACD;AACF;;AAED,QAAMI,aAAaC,OAAOC,IAAP,CAAYT,IAAZ,CAAnB;;AAEA,QAAMU,SAAS,EAAf;;AAEA,OAAK,MAAMC,SAAX,IAAwBJ,UAAxB,EAAoC;AAClC,UAAMK,QAAQZ,KAAKW,SAAL,CAAd;;AAEA,QAAIE,MAAMC,OAAN,CAAcF,KAAd,CAAJ,EAA0B;AACxBF,aAAOC,SAAP,IAAoBC,MAAMG,GAAN,CAAWC,SAAD,IAAe;AAC3C,YAAI,OAAOA,SAAP,KAAqB,QAAzB,EAAmC;AACjC,iBAAOA,SAAP;AACD;;AAED,eAAOjB,QAAQiB,SAAR,EAAmBf,KAAnB,EAA0BC,KAAKe,MAAL,CAAY,CAACN,SAAD,CAAZ,CAA1B,CAAP;AACD,OANmB,CAApB;AAOD,KARD,MAQO,IAAI,OAAOC,KAAP,KAAiB,QAAjB,IAA6BA,UAAU,IAA3C,EAAiD;AACtDF,aAAOC,SAAP,IAAoBZ,QAAQa,KAAR,EAAeX,KAAf,EAAsBC,KAAKe,MAAL,CAAY,CAACN,SAAD,CAAZ,CAAtB,CAApB;AACD,KAFM,MAEA;AACLD,aAAOC,SAAP,IAAoBC,KAApB;AACD;AACF;;AAED,SAAOF,MAAP;AACD,CA9CD;;kBAgDgBQ,QAAD,IAAsB;AACnC,QAAMjB,QAAQ,EAAd;;AAEA,SAAOF,QAAQmB,QAAR,EAAkBjB,KAAlB,EAAyB,EAAzB,CAAP;AACD,C","file":"deflate.js","sourcesContent":["// @flow\n\n// eslint-disable-next-line complexity\nconst deflate = (node: Object, index: Object, path: $ReadOnlyArray<string>) => {\n  if (node && node.id && node.__typename) {\n    const route = path.join(',');\n\n    if (index[route] && index[route][node.__typename] && index[route][node.__typename][node.id]) {\n      return {\n        // eslint-disable-next-line id-match\n        __typename: node.__typename,\n        id: node.id\n      };\n    } else {\n      if (!index[route]) {\n        index[route] = {};\n      }\n\n      if (!index[route][node.__typename]) {\n        index[route][node.__typename] = {};\n      }\n\n      index[route][node.__typename][node.id] = true;\n    }\n  }\n\n  const fieldNames = Object.keys(node);\n\n  const result = {};\n\n  for (const fieldName of fieldNames) {\n    const value = node[fieldName];\n\n    if (Array.isArray(value)) {\n      result[fieldName] = value.map((childNode) => {\n        if (typeof childNode === 'string') {\n          return childNode;\n        }\n\n        return deflate(childNode, index, path.concat([fieldName]));\n      });\n    } else if (typeof value === 'object' && value !== null) {\n      result[fieldName] = deflate(value, index, path.concat([fieldName]));\n    } else {\n      result[fieldName] = value;\n    }\n  }\n\n  return result;\n};\n\nexport default (response: Object) => {\n  const index = {};\n\n  return deflate(response, index, []);\n};\n"]}